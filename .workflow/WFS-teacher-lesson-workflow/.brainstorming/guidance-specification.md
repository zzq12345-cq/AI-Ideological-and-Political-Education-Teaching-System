# 教师备课上课流程设计 - 确认指导规范

**生成时间**: 2026-02-02
**会话ID**: WFS-teacher-lesson-workflow
**参与角色**: product-manager, ui-designer, data-architect
**项目**: AI思政智慧课堂系统 - 教师教学工作流模块

---

## 1. 项目定位与目标

### CONFIRMED 项目范围
教师完整教学工作流设计，覆盖三大阶段：
- **备课准备**：课件制作、AI辅助备课、试题准备、教案规划
- **课堂授课**：签到管理、基础答题、课堂信息展示（暂不含实时通信方案）
- **课后总结**：作业布置、学情分析、教学反思

### CONFIRMED 用户规模
- **目标场景**：小班教学（30人以内）
- **技术要求**：单教室场景，交互响应要求高，并发压力可控

### CONFIRMED 用户边界
- **本期范围**：仅教师端功能
- **后续规划**：学生端功能单独迭代

### CONFIRMED 核心诉求
- **备课重点**：全流程覆盖（课件+试题+教案一体化）
- **互动方式**：基础互动（签到+普通答题），暂不实现实时通信方案
- **分析维度**：综合学情画像（课堂+作业+考试全维度）

---

## 2. 产品经理决策

### SELECTED MVP策略
**备课优先策略**
- 第一期：完善AI备课全流程（课件生成、智能组卷、教案规划）
- 第二期：课堂管理基础功能（签到、发题、课堂状态）
- 第三期：课后总结与学情分析

### SELECTED 模块整合策略
**重构统一入口**
- 新建统一备课工作台
- 整合现有 AIPreparationWidget 和 QuestionBankWindow 功能
- 采用渐进式迁移，保持现有功能兼容

### Cross-Role Integration
**设计先行，实现分期**
- UI设计完整覆盖三阶段
- 实现按备课优先顺序分期交付
- 框架和导航一次性搭建完成

---

## 3. UI设计师决策

### SELECTED 备课工作台布局
**左右分栏（IDE风格）**
- 左侧：导航树（课程/课时/资源目录）
- 右侧：内容编辑区（课件/试题/教案）
- 与现有ModernMainWindow集成：保留主侧边栏，备课工作台作为内容区

### SELECTED 课堂控制面板
**信息仪表盘**
- 实时显示签到人数、到课率
- 答题进度和正确率统计
- 课堂时间和状态指示

### SELECTED 学情可视化
**列表+图表混合**
- 数据表格展示学生详情
- 图表展示趋势和分布
- 兼顾详情查看和整体分析

### Cross-Role Integration
**导航融合方案**
- 保留ModernMainWindow主侧边栏导航
- 备课工作台作为内容区，内部再实现左右分栏
- 形成双层布局：主导航 → 备课导航树 → 内容区

---

## 4. 数据架构师决策

### SELECTED 核心数据模型
**以课程为中心**
```
Course (课程)
  └── Lesson (课时)
        ├── LessonPlan (教案)
        ├── Courseware (课件)
        ├── Quiz (课堂测验)
        ├── Attendance (签到记录)
        └── Homework (作业)
              └── Submission (提交记录)
```

### SELECTED 学情画像维度
**均衡多维度分析**
- **知识维度**：知识点掌握度、错题分布、学习进度
- **行为维度**：出勤率、课堂参与度、作业完成率
- **成绩维度**：测验成绩、作业成绩、综合评分
- **权重配置**：支持教师自定义各维度权重

### SELECTED 数据存储策略
**分层存储**
- **元数据**：Supabase PostgreSQL（课程、课时、成绩等结构化数据）
- **大文件**：本地文件系统（课件PPT、教案文档、录音文件）
- **适用场景**：单机部署，简化架构

---

## 5. 跨角色集成点

### CONFIRMED 技术集成
| 集成点 | 现有模块 | 集成方式 |
|--------|----------|----------|
| AI对话 | DifyService | 复用现有SSE流式服务 |
| PPT生成 | XunfeiPPTService | 嵌入备课工作台 |
| 试题库 | QuestionBankWindow | 渐进式迁入统一入口 |
| 数据分析 | DataAnalyticsWidget | 扩展学情分析维度 |
| 用户认证 | SupabaseClient | 复用现有认证体系 |

### CONFIRMED 导航结构
```
ModernMainWindow (主窗口)
├── 侧边栏导航
│   ├── 首页
│   ├── 备课工作台 ← 新增统一入口
│   ├── 课堂管理 ← 新增
│   ├── 学情分析 ← 扩展现有
│   ├── 试题库 ← 保留兼容
│   └── 设置
└── 内容区
    └── 备课工作台 (左右分栏)
        ├── 左侧导航树
        └── 右侧内容区
```

---

## 6. 风险与约束

### 识别的风险
| 风险 | 影响 | 缓解措施 |
|------|------|----------|
| 渐进式迁移复杂度 | 新旧模块并存期间维护成本增加 | 明确迁移时间表，旧模块标记废弃 |
| 本地文件存储限制 | 不支持多设备同步 | 预留对象存储接口，后续可迁移 |
| 全流程备课工作量大 | 第一期交付周期可能较长 | MVP聚焦核心功能，非核心功能后置 |

### CONFIRMED 约束条件
- **技术栈**：Qt6/C++，Supabase后端，Dify AI服务
- **部署模式**：单机桌面应用
- **兼容性**：保持现有功能正常运行

---

## 7. 下一步行动

### 自动继续流程
auto-parallel 将自动执行以下步骤：
1. ✅ **Phase 1 (artifacts)**: 交互式框架生成 - 已完成
2. ⏳ **Phase 2 (role agents)**: 并行角色分析
   - product-manager: 产品规划与路线图分析
   - ui-designer: 界面设计与交互流程分析
   - data-architect: 数据模型与存储架构分析
3. ⏳ **Phase 3 (synthesis)**: 综合整合与冲突解决

---

## 附录：决策追踪表

| ID | 类别 | 问题 | 决策 | 阶段 | 理由 |
|----|------|------|------|------|------|
| D-001 | 意图 | 用户规模 | 小班教学(30人内) | 1 | 交互要求高，并发可控 |
| D-002 | 意图 | 备课重点 | 全流程覆盖 | 1 | 一体化工作流需求 |
| D-003 | 意图 | 课堂互动 | 基础互动(签到+答题) | 1 | 快速上线，技术简化 |
| D-004 | 意图 | 数据分析 | 综合画像 | 1 | 全维度学情评估 |
| D-005 | 角色 | 参与角色 | PM+UI+数据架构 | 2 | 覆盖产品/设计/数据 |
| D-006 | PM | MVP优先级 | 备课优先 | 3 | 核心功能先行 |
| D-007 | PM | 用户边界 | 仅教师端 | 3 | 专注核心用户 |
| D-008 | PM | 模块整合 | 重构统一入口 | 3 | 体验一致性 |
| D-009 | UI | 备课布局 | 左右分栏IDE风格 | 3 | 高效操作体验 |
| D-010 | UI | 课堂面板 | 信息仪表盘 | 3 | 实时状态可见 |
| D-011 | UI | 学情展示 | 列表+图表混合 | 3 | 详情与趋势兼顾 |
| D-012 | 数据 | 核心模型 | 以课程为中心 | 3 | 层级清晰 |
| D-013 | 数据 | 画像维度 | 均衡多维 | 3 | 综合评估 |
| D-014 | 数据 | 存储策略 | 分层存储 | 3 | 架构简化 |
| D-015 | 跨角色 | 设计vs实现 | 设计先行 | 4 | 完整规划分期交付 |
| D-016 | 跨角色 | 迁移策略 | 渐进式迁移 | 4 | 保持兼容 |
| D-017 | 跨角色 | 导航融合 | 替换内容区 | 4 | 双层布局 |
| D-018 | 跨角色 | 文件存储 | 本地文件系统 | 4 | 单机部署适配 |
