# UI设计师视角分析 - 教师备课上课流程设计

**角色**: UI设计师 (ui-designer)
**分析时间**: 2026-02-02
**会话ID**: WFS-teacher-lesson-workflow
**项目**: AI思政智慧课堂系统 - 教师教学工作流模块

---

## 1. 设计原则与风格指南

### 1.1 视觉设计语言

基于现有项目的QSS样式分析，系统采用**思政智慧课堂色彩体系**：

| 颜色角色 | 色值 | 应用场景 |
|---------|------|----------|
| 主思政红 | #e53935 | 主按钮、焦点边框、强调色 |
| 亮思政红 | #ef5350 | 悬停状态 |
| 深思政红 | #c62828 | 按下状态、选中文字 |
| 淡思政红 | #ffebee | 选中背景、高亮区域 |
| 智慧蓝 | #1976d2 | 信息提示、链接 |
| 成长绿 | #388e3c | 成功状态、正向指标 |
| 文化金 | #f57c00 | 警告状态、重要提示 |
| 学术紫 | #7b1fa2 | 特殊标签、高级功能 |

**背景层级**:
- 主背景: #fafafa
- 卡片背景: #ffffff
- 分隔线: #e8eaf6

**文字层级**:
- 主文字: #212121
- 次要文字: #424242
- 辅助文字: #757575
- 禁用文字: #9e9e9e

### 1.2 设计原则

1. **一致性优先**: 新模块必须与现有ModernMainWindow风格保持统一
2. **渐进披露**: 复杂功能分层展示，避免信息过载
3. **即时反馈**: 所有操作提供明确的视觉反馈
4. **高效操作**: 减少点击次数，支持键盘快捷键
5. **可访问性**: 保证足够的对比度和可点击区域

### 1.3 组件规范

| 组件类型 | 圆角 | 内边距 | 边框 |
|---------|------|--------|------|
| 卡片容器 | 6-8px | 16-24px | 1px #e8eaf6 |
| 按钮 | 6px | 8px 16px | 1px |
| 输入框 | 8px | 8px 12px | 1px #e8eaf6 |
| 对话框 | 8px | 24px | 1px #e8eaf6 |

### 1.4 需求澄清与决策记录（Clarifications）

| 类别 | 问题 | 结论 |
|------|------|------|
| Requirements | P0阶段必须可用范围？ | 仅备课工作台（课件/试题/教案），课堂管理与学情分析占位 |
| Architecture | 非实时交互刷新策略？ | 手动+定时结合（默认定时，关键操作后手动触发） |
| Requirements | 无学生端的数据采集方案？ | 名单导入 + 二维码签到 + 轻量H5答题 |
| Decisions | 发布动作语义？ | 发布=备课完成，可进入授课 |
| Risk | 文件版本策略？ | 关键节点版本（发布/导出时） |
| UX | 迁移引导策略？ | 首次进入弹窗引导 + 教学向导 |

**补充说明（用于全文对齐）**:
- P0仅开放备课工作台，课堂管理/学情分析保留入口占位并使用禁用态按钮与流程说明。
- 刷新采用“默认定时 + 关键操作手动触发”，非实时场景均展示“上次更新”提示。
- 无学生端数据采集通过名单导入 + 二维码签到 + 轻量H5答题完成。
- “发布”即备课完成并进入授课流程（P0仅展示可授课状态与占位引导）。
- 版本仅在发布/导出等关键节点生成，避免版本噪音。
- 迁移引导包含首次弹窗提示与教学向导分步任务。

---

## 2. 现有UI模式分析

### 2.1 ModernMainWindow 架构

```
ModernMainWindow (主窗口)
├── MenuBar (菜单栏)
├── Central Widget
│   ├── Sidebar (侧边栏 - 200px宽度)
│   │   ├── ProfileWidget (用户头像区)
│   │   ├── Navigation Buttons (导航按钮)
│   │   │   ├── 教师中心 (Dashboard)
│   │   │   ├── 时政新闻
│   │   │   ├── AI智能备课
│   │   │   ├── 资源库管理
│   │   │   ├── 学情与教评
│   │   │   └── 数据分析报告
│   │   └── Bottom Buttons (设置/帮助)
│   └── Content Area (内容区)
│       └── QStackedWidget (页面切换)
│           ├── DashboardWidget
│           ├── HotspotTrackingWidget
│           ├── AIPreparationWidget
│           ├── QuestionBankWindow
│           └── DataAnalyticsWidget
└── StatusBar (状态栏)
```

- 术语对齐：侧边栏现有“学情与教评”在P0文案统一为“学情分析”（占位页），与三阶段流程一致。

### 2.2 现有组件模式

#### AIPreparationWidget 模式
- 顶部标题区 + 配置选项
- 模板选择卡片网格
- 预览区域（卡片网格）
- 底部操作栏
- 状态切换（Idle/Generating/Success/Failed）
- 进度动画反馈

#### QuestionBankWindow 模式
- 左侧筛选侧边栏
- 右侧内容滚动区
- 题目卡片列表
- 试题篮浮动面板

#### DataAnalyticsWidget 模式
- 顶部导航标签页
- 指标卡片网格
- 图表区域（柱状图/折线图）
- AI报告生成区

### 2.3 设计模式总结

| 模式 | 适用场景 | 现有示例 |
|------|----------|----------|
| 卡片网格 | 多选项选择 | 模板选择、预览缩略图 |
| 左右分栏 | 筛选+内容 | 试题库窗口 |
| 标签页切换 | 多视图切换 | 数据分析（概览/个人/班级） |
| 状态机驱动 | 异步操作 | PPT生成状态 |
| 浮动面板 | 临时信息 | 试题篮 |

---

## 3. 页面结构与导航设计

### 3.1 导航层级架构（已确认）

根据guidance-specification.md决策D-017，采用**双层布局**方案：

```
ModernMainWindow (主窗口)
├── 主侧边栏 (保留现有)
│   ├── 教师中心
│   ├── 时政新闻
│   ├── [备课工作台] ← 新增统一入口
│   ├── [课堂管理] ← 新增
│   ├── 学情分析 ← 扩展现有
│   ├── 试题库 ← 保留兼容
│   └── 设置/帮助
└── 内容区
    └── 备课工作台 (新增左右分栏)
        ├── 左侧导航树 (240px)
        │   └── 课程/课时/资源目录
        └── 右侧内容区 (flex-1)
            └── 课件/试题/教案编辑器
```

**三阶段流程对齐（需求意图）**:
- 备课工作台（备课阶段）→ 发布 → 课堂管理（授课阶段）→ 学情分析（复盘阶段）
- 课堂管理与学情分析在P0阶段仅作为占位入口，完整面板设计保留为后续迭代蓝图

**术语统一**:
- 备课工作台：备课阶段统一入口
- 课堂管理：授课阶段主面板（ClassroomPanel）
- 学情分析：学习成效复盘页面（LearningAnalysis）
- 学情分析与侧边栏既有“学情与教评”视为同一模块，P0阶段文案统一为“学情分析”并使用占位页

### 3.2 主侧边栏更新

**新增导航项**:

| 导航项 | 图标建议 | 页面索引 | 描述 |
|--------|----------|----------|------|
| 备课工作台 | 书本+铅笔 | 8 | 统一备课入口 |
| 课堂管理 | 讲台/教室 | 9 | 授课控制面板 |

**保持兼容**:
- AI智能备课 和 资源库管理 暂时保留
- 后续通过渐进式迁移，将功能整合到备课工作台
- 迁移完成后可隐藏或移除旧入口
- P0阶段从旧入口跳转时增加“新入口优先”的轻提示，避免重复编辑

**P0阶段可用范围（EP-001）**:
- 仅开放「备课工作台」（课件/试题/教案）
- 「课堂管理」与「学情分析」保留入口但进入后为占位页，显示“即将开放”与流程说明
- 占位页主操作按钮展示禁用态，并提供“了解流程/查看示例”轻入口
- 占位页文案统一强调“发布后可进入授课/授课完成后可查看学情”，避免期望误差
- 占位页强调P0为结构示意，避免用户误认为可实际授课/出报告

**迁移引导策略（EP-004）**:
- 首次进入备课工作台展示弹窗引导，解释新旧入口关系与关键变化
- 在旧入口旁标注“即将迁移”，提供“一键跳转到备课工作台”
- 提供教学向导（分步任务：建课/建课时/完成课件-试题-教案/发布进入授课）
- 向导包含“发布=备课完成”的提示节点，确保理解发布语义
- 首次进入引导支持“本次不再提示”，并在帮助中心保留入口

**非实时刷新策略（EP-002）**:
- 默认定时刷新（如每5-10分钟）+ 关键操作后手动触发
- 在页面右上角或状态栏展示“上次更新”与刷新按钮
- 刷新中提示不遮挡主编辑区，避免打断任务
- 对非实时数据卡片统一标注“非实时”提示，避免误解

### 3.3 页面路由设计

```cpp
enum PageIndex {
    Dashboard = 0,        // 教师中心
    NewsTracking = 1,     // 时政新闻
    AIPreparation = 2,    // AI智能备课（保留）
    ResourceManagement = 3,// 资源库管理（保留）
    LearningAnalysis = 4, // 学情分析
    DataAnalysis = 5,     // 数据分析
    Settings = 6,
    Help = 7,
    // 新增
    LessonWorkbench = 8,  // 备课工作台
    ClassroomPanel = 9,   // 课堂管理
};
```

---

## 4. 备课工作台布局详解

### 4.1 整体布局（已确认：IDE风格左右分栏）

```
┌─────────────────────────────────────────────────────────────────┐
│  [返回]  备课工作台 - 思想政治 第一课              [保存] [发布]  │
├──────────┬──────────────────────────────────────────────────────┤
│          │  工具栏: [课件] [试题] [教案] [预览] | [AI助手]       │
│ 课程目录 ├──────────────────────────────────────────────────────┤
│          │                                                      │
│ v 马原   │           主编辑区                                   │
│   > 第一课│           (根据选中资源类型动态切换)                 │
│   > 第二课│                                                      │
│     - 课件│           - 课件编辑: 幻灯片预览+属性面板            │
│     - 试题│           - 试题编辑: 题目列表+编辑器                 │
│     - 教案│           - 教案编辑: 富文本编辑器                    │
│   > 第三课│                                                      │
│          │                                                      │
│ v 近代史 │                                                      │
│   ...    │                                                      │
│          │                                                      │
├──────────┴──────────────────────────────────────────────────────┤
│  状态栏: 上次保存: 10:30 | 课件: 12页 | 试题: 5道 | 已同步      │
└─────────────────────────────────────────────────────────────────┘
```

**发布动作语义（EP-006）**:
- 发布=备课完成，进入授课准备态
- 发布后在课堂管理入口展示“可授课”状态标签（P0占位页仍不可操作）
- 发布按钮支持二次确认，文案强调“发布后进入授课流程”
- 发布状态可回溯到当前备课版本（与关键节点版本策略联动）

**关键节点版本策略（EP-007）**:
- 仅在发布/导出时生成版本快照，编辑过程不产生密集版本
- 在状态栏显示最近版本时间与版本标记
- 版本查看入口放在“更多”菜单，避免干扰主流程

**非实时刷新策略（EP-002）**:
- 默认定时刷新（如每5-10分钟）+ 关键操作后手动触发
- 手动刷新入口放置在状态栏或工具栏右侧，配合“上次更新”提示
- 刷新过程中提供轻量加载提示，不阻断编辑
- 对统计/同步/版本提示等非实时区域统一标注“非实时/上次更新”

### 4.2 左侧导航树设计

**树形结构**:
```
课程名称 (折叠/展开)
├── 课时1：xxx
│   ├── 课件 (PPT/PPTX)
│   ├── 试题集 (关联题目)
│   └── 教案 (教学设计)
├── 课时2：xxx
│   └── ...
└── [+ 添加课时]
```

**交互设计**:
- 单击选中，双击重命名
- 拖拽调整顺序
- 右键菜单：新建/复制/删除/导出
- 资源图标区分类型（PPT图标、试卷图标、文档图标）

**实现建议**:
```cpp
class LessonTreeWidget : public QTreeWidget {
    // 自定义树形控件
    // 支持拖拽排序
    // 右键上下文菜单
    // 图标和状态指示
};
```

### 4.3 右侧编辑区设计

采用QStackedWidget实现多类型编辑器切换：

#### 4.3.1 课件编辑器布局

```
┌────────────────────────────────────────────────────────┐
│  工具栏: [+ 新幻灯片] [模板] [主题] | [讯飞AI生成]     │
├────────────────────┬───────────────────────────────────┤
│                    │                                   │
│  幻灯片缩略图      │      幻灯片预览区                 │
│  (垂直列表)        │      (大图展示当前幻灯片)         │
│                    │                                   │
│  [1] 封面          │      ┌─────────────────────────┐  │
│  [2] 目录          │      │                         │  │
│  [3] 内容1         │      │    当前幻灯片内容       │  │
│  [4] 内容2         │      │                         │  │
│  ...               │      │                         │  │
│                    │      └─────────────────────────┘  │
│                    │                                   │
│  [+ 新增幻灯片]    │      [全屏预览] [编辑] [导出]    │
│                    │                                   │
└────────────────────┴───────────────────────────────────┘
```

**复用现有组件**:
- SlidePreviewDialog 预览对话框
- XunfeiPPTService AI生成服务
- PPTXGenerator 导出服务

#### 4.3.2 试题编辑器布局

```
┌────────────────────────────────────────────────────────┐
│  工具栏: [+ 新建] [从题库添加] [AI出题] | [预览] [导出] │
├────────────────────────────────────────────────────────┤
│                                                        │
│  试题列表                                              │
│  ┌──────────────────────────────────────────────────┐  │
│  │ 1. [单选题] 社会主义核心价值观中...    [编辑][删除] │  │
│  │    A. 富强  B. 民主  C. 文明  D. 和谐   正确: A   │  │
│  ├──────────────────────────────────────────────────┤  │
│  │ 2. [多选题] 新时代的主要矛盾...        [编辑][删除] │  │
│  │    A. xxx  B. xxx  ...                正确: AB   │  │
│  ├──────────────────────────────────────────────────┤  │
│  │ 3. [材料题] 阅读以下材料...            [编辑][删除] │  │
│  └──────────────────────────────────────────────────┘  │
│                                                        │
│  ─────────────────────────────────────────────────────  │
│  试题统计: 共5题 | 单选3 | 多选1 | 材料1 | 预计15分钟   │
│                                                        │
└────────────────────────────────────────────────────────┘
```

**与试题库集成**:
- 复用 QuestionBankWindow 的筛选和展示逻辑
- 复用 QuestionBasketWidget 的选题机制
- 新增嵌入式试题编辑器组件

**无学生端数据采集方案（EP-003）**:
- 备课工作台内提供“学生名单导入”入口（CSV/Excel），用于课堂管理的基础数据
- 课堂管理占位页展示“二维码签到/轻量H5答题”引导说明与演示入口
- 在发布前检查是否已导入名单，未导入时提示“建议先导入名单以便课堂数据采集”
- 发布后的课堂管理占位页提供“生成签到二维码”的演示按钮与流程说明
- 轻量H5答题入口文案强调“无需学生端安装”，降低采集门槛

#### 4.3.3 教案编辑器布局

```
┌────────────────────────────────────────────────────────┐
│  工具栏: [格式] [插入] | [AI生成大纲] [教学建议]       │
├────────────────────────────────────────────────────────┤
│                                                        │
│  ┌────────────────────────────────────────────────┐    │
│  │                                                │    │
│  │   富文本编辑区                                 │    │
│  │                                                │    │
│  │   # 教学目标                                   │    │
│  │   - 知识目标: ...                              │    │
│  │   - 能力目标: ...                              │    │
│  │   - 情感目标: ...                              │    │
│  │                                                │    │
│  │   # 教学重难点                                 │    │
│  │   - 重点: ...                                  │    │
│  │   - 难点: ...                                  │    │
│  │                                                │    │
│  │   # 教学过程                                   │    │
│  │   ## 导入 (5分钟)                              │    │
│  │   ## 新授 (30分钟)                             │    │
│  │   ## 练习 (10分钟)                             │    │
│  │   ## 小结 (5分钟)                              │    │
│  │                                                │    │
│  └────────────────────────────────────────────────┘    │
│                                                        │
└────────────────────────────────────────────────────────┘
```

**编辑器特性**:
- Markdown支持（复用现有MarkdownRenderer）
- 教案模板快速填充
- AI辅助生成（复用DifyService）

### 4.4 AI助手面板设计

备课工作台右侧可滑出AI助手面板：

```
┌────────────────────────────────────────┐
│  AI备课助手                     [收起] │
├────────────────────────────────────────┤
│                                        │
│  ┌────────────────────────────────┐    │
│  │ 我可以帮您:                    │    │
│  │ - 生成教学PPT                  │    │
│  │ - 智能出题                     │    │
│  │ - 撰写教案                     │    │
│  │ - 解答教学问题                 │    │
│  └────────────────────────────────┘    │
│                                        │
│  ┌────────────────────────────────┐    │
│  │ 用户: 帮我生成第一课的PPT      │    │
│  └────────────────────────────────┘    │
│  ┌────────────────────────────────┐    │
│  │ AI: 好的，我来为您生成...     │    │
│  │ [进度条: 正在生成...]          │    │
│  └────────────────────────────────┘    │
│                                        │
├────────────────────────────────────────┤
│  [输入框...]              [发送]       │
└────────────────────────────────────────┘
```

**复用现有组件**:
- ChatWidget 气泡样式聊天
- DifyService SSE流式响应
- ChatHistoryWidget 历史记录

---

## 5. 课堂管理面板设计

### 5.1 整体布局（已确认：信息仪表盘）

**P0阶段占位策略（EP-001）**:
- 课堂管理在P0阶段展示占位页，强调“发布后可进入授课流程”
- 核心卡片与互动区保留结构示意，但置灰不可用，并附“即将开放”说明
- 占位页保留“生成签到二维码/查看流程示例”的演示入口，避免操作断层
- 示意布局为后续迭代蓝图，P0仅展示结构线框与禁用态
- 指标区统一展示“上次更新/非实时”提示，避免对实时性误判

```
┌─────────────────────────────────────────────────────────────────┐
│  课堂管理 - 第一课：社会主义核心价值观        [结束上课] [设置]  │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌────────────┐ ┌────────────┐ ┌────────────┐ ┌────────────┐   │
│  │ 签到人数   │ │ 到课率     │ │ 课堂时长   │ │ 当前环节   │   │
│  │   28/30    │ │   93.3%    │ │  35:20     │ │  新授课    │   │
│  │ [开始签到] │ │ +2人待确认 │ │            │ │ [下一环节] │   │
│  └────────────┘ └────────────┘ └────────────┘ └────────────┘   │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│  课堂互动                                                       │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │  当前题目: 社会主义核心价值观包含几个层面?                │  │
│  │                                                           │  │
│  │  答题进度: ████████████░░░░ 25/28 (89%)                   │  │
│  │                                                           │  │
│  │  正确率统计:                                              │  │
│  │  A. 2个层面  ████ 12%                                     │  │
│  │  B. 3个层面  ████████████████ 72%  [正确]                 │  │
│  │  C. 4个层面  ████ 16%                                     │  │
│  │                                                           │  │
│  │  [发布下一题] [查看详情] [结束答题]                       │  │
│  └───────────────────────────────────────────────────────────┘  │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│  学生状态列表                                                   │
│  ┌────────────────────────────────────────────────────────────┐ │
│  │ 姓名      签到   最近答题   正确率   状态                  │ │
│  │ 张三      已签   A (正确)   80%     [在线]                 │ │
│  │ 李四      已签   B (正确)   75%     [在线]                 │ │
│  │ 王五      未签   -          -       [离线]                 │ │
│  │ ...                                                        │ │
│  └────────────────────────────────────────────────────────────┘ │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 5.2 核心指标卡片设计

**卡片规格**:
- 尺寸: 180px x 120px
- 圆角: 8px
- 阴影: 0 2px 8px rgba(0,0,0,0.08)
- 主数值字号: 32px bold
- 副标题字号: 14px

**指标卡片**:

| 指标 | 主数值 | 副信息 | 操作按钮 |
|------|--------|--------|----------|
| 签到人数 | 28/30 | 缺勤名单 | 开始签到 |
| 到课率 | 93.3% | 趋势箭头 | - |
| 课堂时长 | 35:20 | 计划45分钟 | - |
| 当前环节 | 新授课 | 进度条 | 下一环节 |

### 5.3 答题互动区设计

**题目展示区**:
```
┌─────────────────────────────────────────────────────┐
│  [单选题] 第3题                            [难度:中] │
├─────────────────────────────────────────────────────┤
│                                                     │
│  题干内容...                                        │
│                                                     │
│  A. 选项A                                           │
│  B. 选项B                                           │
│  C. 选项C                                           │
│  D. 选项D                                           │
│                                                     │
└─────────────────────────────────────────────────────┘
```

**答题统计区**:
- 实时进度条（已答/总人数）
- 选项分布柱状图（水平条形图）
- 正确答案高亮标识
- 倒计时显示（可选）

### 5.4 学生状态列表设计

**表格列定义**:

| 列名 | 宽度 | 对齐 | 说明 |
|------|------|------|------|
| 头像/姓名 | 120px | 左 | 头像+姓名 |
| 签到状态 | 80px | 中 | 已签/未签/迟到 |
| 最近答题 | 100px | 中 | 答案+正误标记 |
| 累计正确率 | 80px | 中 | 百分比 |
| 在线状态 | 80px | 中 | 在线/离线 |
| 操作 | 100px | 中 | 提醒/查看 |

**状态颜色编码**:
- 在线: #388e3c (绿色)
- 离线: #9e9e9e (灰色)
- 未签: #f57c00 (橙色警告)
- 正确: #388e3c
- 错误: #e53935

---

## 6. 学情分析页面设计

### 6.1 整体布局（已确认：列表+图表混合）

**P0阶段占位策略（EP-001）**:
- 学情分析在P0阶段展示占位页与“授课完成后可查看学情”的说明
- 主要图表区域以示意图+空状态呈现，减少误解
- 指标与图表区域展示“非实时/上次更新”提示，统一刷新感知

```
┌─────────────────────────────────────────────────────────────────┐
│  学情分析                               [导出报告] [AI分析]      │
├─────────────────────────────────────────────────────────────────┤
│  筛选: [班级 v] [课程 v] [时间范围 v]              [刷新]        │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │  综合指标                                               │   │
│  │  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐   │   │
│  │  │ 平均出勤 │ │ 作业完成 │ │ 测验均分 │ │ 综合评分 │   │   │
│  │  │   92%    │ │   88%    │ │   76.5   │ │   B+     │   │   │
│  │  │   +3%    │ │   -2%    │ │   +2.3   │ │          │   │   │
│  │  └──────────┘ └──────────┘ └──────────┘ └──────────┘   │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ┌─────────────────────────┬───────────────────────────────┐   │
│  │  成绩分布 (柱状图)      │  趋势变化 (折线图)            │   │
│  │                         │                               │   │
│  │   ▓▓▓▓▓                 │     ──●──●──●                 │   │
│  │   ▓▓▓▓▓▓▓▓              │    /                          │   │
│  │   ▓▓▓▓                  │   ●                           │   │
│  │   ▓▓                    │                               │   │
│  │  优秀 良好 及格 不及格  │  W1  W2  W3  W4  W5           │   │
│  └─────────────────────────┴───────────────────────────────┘   │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │  学生详情列表                                           │   │
│  │  姓名   出勤率   作业   测验   综合   状态   操作       │   │
│  │  张三   95%     90%   82     A     正常   [详情]       │   │
│  │  李四   88%     85%   78     B+    正常   [详情]       │   │
│  │  王五   72%     60%   55     C     预警   [详情]       │   │
│  │  ...                                                    │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 6.2 指标维度展示（已确认：均衡多维度）

根据数据架构师决策，展示三个维度：

**知识维度**:
- 知识点掌握雷达图
- 错题分布统计
- 学习进度条

**行为维度**:
- 出勤率趋势
- 课堂参与度
- 作业完成率

**成绩维度**:
- 测验成绩分布
- 作业成绩统计
- 综合评分等级

### 6.3 图表组件复用

复用 DataAnalyticsWidget 中的图表组件：
- QBarSeries 柱状图
- QLineSeries 折线图
- QChartView 图表视图

新增图表类型：
- 雷达图（知识点掌握）
- 热力图（时间活跃度）

### 6.4 学生详情弹窗设计

```
┌─────────────────────────────────────────────────────────┐
│  学生画像 - 张三                                   [X] │
├─────────────────────────────────────────────────────────┤
│  ┌──────────┐                                          │
│  │  头像    │  姓名: 张三                              │
│  │          │  班级: 思政2024级1班                     │
│  │          │  学号: 20240001                          │
│  └──────────┘  综合评级: A (优秀)                      │
│                                                        │
├─────────────────────────────────────────────────────────┤
│  学习画像                                              │
│  ┌─────────────────────────────────────────────────┐  │
│  │  知识掌握雷达图          近期成绩趋势          │  │
│  │       核心价值观             ●──●──●            │  │
│  │         ●                   /      \           │  │
│  │    ●         ●            ●          ●         │  │
│  │         ●                                      │  │
│  └─────────────────────────────────────────────────┘  │
│                                                        │
│  行为分析                                              │
│  - 出勤率: 95% (班级平均: 92%)                        │
│  - 课堂参与: 活跃 (平均每节回答3次)                   │
│  - 作业完成: 准时提交率 100%                          │
│                                                        │
│  AI 建议                                               │
│  该学生整体表现优秀，建议...                          │
│                                                        │
├─────────────────────────────────────────────────────────┤
│                              [关闭] [导出PDF] [发送提醒] │
└─────────────────────────────────────────────────────────┘
```

---

## 7. 组件复用策略

### 7.1 可复用组件清单

| 组件 | 来源 | 复用场景 | 改造需求 |
|------|------|----------|----------|
| ChatWidget | src/ui/ChatWidget | AI助手面板 | 嵌入式尺寸适配 |
| SlidePreviewDialog | src/ui/aipreparationwidget | 课件预览 | 直接复用 |
| QuestionBasketWidget | src/questionbank | 试题选择 | 添加嵌入模式 |
| MarkdownRenderer | src/utils | 教案编辑 | 直接复用 |
| MetricCard | Dashboard | 课堂仪表盘 | 参数化配置 |
| QChartView | DataAnalyticsWidget | 学情图表 | 直接复用 |

### 7.2 新增基础组件

#### 7.2.1 TreeNavigator 导航树组件
```cpp
class TreeNavigator : public QTreeWidget {
    Q_OBJECT
public:
    // 课程-课时-资源三级结构
    void setCourseData(const CourseData& data);
    void addLesson(const Lesson& lesson);
    void addResource(const QString& lessonId, ResourceType type);

signals:
    void resourceSelected(const QString& resourceId, ResourceType type);
    void lessonContextMenu(const QString& lessonId, QPoint pos);
};
```

#### 7.2.2 StatusIndicator 状态指示器
```cpp
class StatusIndicator : public QFrame {
    Q_OBJECT
public:
    enum Status { Online, Offline, Warning, Error };
    void setStatus(Status status);
    void setLabel(const QString& text);
};
```

#### 7.2.3 ProgressCard 进度卡片
```cpp
class ProgressCard : public QFrame {
    Q_OBJECT
public:
    void setProgress(int current, int total);
    void setLabel(const QString& label);
    void setColorScheme(const QString& primary, const QString& secondary);
};
```

### 7.3 服务层复用

| 服务 | 复用场景 |
|------|----------|
| DifyService | AI助手、智能出题、教案生成 |
| XunfeiPPTService | 课件AI生成 |
| PaperService | 试题数据CRUD |
| SupabaseClient | 用户认证、数据同步 |

---

## 8. 响应式与可访问性考虑

### 8.1 响应式布局策略

**断点定义**:
| 断点 | 宽度范围 | 布局调整 |
|------|----------|----------|
| 紧凑 | < 1280px | 侧边栏可折叠，单列布局 |
| 标准 | 1280-1600px | 默认双栏布局 |
| 宽屏 | > 1600px | 三栏布局（可选AI面板常驻） |

**动态调整策略**:
```cpp
void LessonWorkbench::resizeEvent(QResizeEvent* event) {
    if (width() < 1280) {
        m_treeNavigator->setMaximumWidth(200);
        m_aiPanel->hide();
    } else if (width() < 1600) {
        m_treeNavigator->setMaximumWidth(240);
        m_aiPanel->setFloating(true);
    } else {
        m_treeNavigator->setMaximumWidth(280);
        m_aiPanel->setDocked(true);
    }
}
```

### 8.2 可访问性设计

**键盘导航**:
- Tab键顺序合理化
- 快捷键支持（Ctrl+S保存、Ctrl+N新建等）
- 焦点状态明确可见

**对比度要求**:
- 文字对比度 >= 4.5:1
- 大文字对比度 >= 3:1
- 焦点指示器对比度 >= 3:1

**屏幕阅读器支持**:
- 所有交互元素设置accessibleName
- 图表提供文字替代描述
- 状态变化通过accessibleDescription通知

---

## 9. 与现有ModernMainWindow集成方案

### 9.1 集成步骤

**Phase 1: 导航扩展**
1. 在SidebarManager中添加新导航项
2. 扩展PageIndex枚举
3. 添加对应的页面切换逻辑
4. 为课堂管理/学情分析提供P0占位页（明确“即将开放”）

**Phase 2: 页面容器**
1. 创建LessonWorkbenchWidget继承QWidget
2. 添加到contentStack
3. 实现与主窗口的信号连接

**Phase 3: 功能迁移**
1. 将AIPreparationWidget功能嵌入备课工作台
2. 集成QuestionBankWindow选题功能
3. 保持旧入口兼容性
4. 引入迁移引导（首次进入弹窗 + 教学向导）

### 9.2 代码结构建议

```
src/
├── workbench/                    # 新增备课工作台模块
│   ├── LessonWorkbenchWidget.h/cpp    # 主容器
│   ├── TreeNavigator.h/cpp            # 课程导航树
│   ├── editors/
│   │   ├── CoursewareEditor.h/cpp     # 课件编辑器
│   │   ├── QuestionEditor.h/cpp       # 试题编辑器
│   │   └── LessonPlanEditor.h/cpp     # 教案编辑器
│   └── panels/
│       └── AIAssistantPanel.h/cpp     # AI助手面板
│
├── classroom/                    # 新增课堂管理模块
│   ├── ClassroomPanelWidget.h/cpp     # 主面板
│   ├── AttendanceCard.h/cpp           # 签到卡片
│   ├── QuizController.h/cpp           # 答题控制器
│   └── StudentStatusList.h/cpp        # 学生状态列表
│
└── analytics/                    # 扩展学情分析
    ├── DataAnalyticsWidget.h/cpp      # 现有，保持
    ├── StudentProfileDialog.h/cpp     # 新增学生画像
    └── KnowledgeRadarChart.h/cpp      # 新增雷达图
```

### 9.3 样式文件扩展

在 `resources/styles/` 添加:
- `workbench.qss` - 备课工作台专用样式
- `classroom.qss` - 课堂管理专用样式

样式保持与 `qt_theme_safe.qss` 一致的设计语言。

---

## 10. 设计交付物清单

### 10.1 设计文档
- [x] 设计原则与风格指南
- [x] 页面结构与导航设计
- [x] 备课工作台详细设计
- [x] 课堂管理面板设计
- [x] 学情分析页面设计
- [x] 组件复用策略
- [x] 响应式与可访问性方案
- [x] 集成方案

### 10.2 后续设计工作（建议）
- [ ] 高保真原型（Figma/Sketch）
- [ ] 交互动效规范
- [ ] 图标资源设计
- [ ] 组件样式详细规格

---

## 11. 设计建议与风险

### 11.1 设计建议

1. **MVP优先**: 第一期聚焦备课工作台核心功能，课堂管理和学情分析以占位页示意
2. **复用优先**: 尽量复用现有组件，减少开发工作量
3. **渐进迁移**: 保持旧入口可用，逐步引导用户使用新工作台
4. **用户反馈**: 早期邀请教师用户测试，收集使用反馈
5. **刷新可感知**: 在状态栏强调“上次更新”，提供手动刷新入口
6. **发布即授课**: 发布按钮文案明确“进入授课流程”，避免误解
7. **版本可追溯**: 仅在发布/导出生成版本快照，避免版本噪音

### 11.2 潜在风险

| 风险 | 影响 | 缓解措施 |
|------|------|----------|
| 双层导航复杂度 | 用户可能困惑 | 提供新手引导、面包屑导航 |
| 编辑器功能过多 | 界面臃肿 | 使用渐进披露、工具栏分组 |
| 刷新节奏不清 | 数据感知不足 | 明确定时刷新频率与“上次更新”提示 |
| 版本噪音过多 | 教师难以定位关键稿 | 仅在发布/导出生成版本快照 |
| 移动端适配 | 小屏体验差 | 本期专注桌面端，移动端后续迭代 |

---

## 12. 参考资源

### 12.1 设计参考
- VSCode 编辑器布局（IDE风格参考）
- Notion 文档编辑体验
- 腾讯课堂 教师端界面
- 雨课堂 课堂互动设计

### 12.2 现有项目资源
- `resources/styles/qt_theme_safe.qss` - 主题样式
- `src/ui/aipreparationwidget.h` - AI备课组件
- `src/questionbank/questionbankwindow.h` - 试题库窗口
- `src/analytics/DataAnalyticsWidget.h` - 数据分析组件

---

**文档版本**: v1.0
**分析完成时间**: 2026-02-02
**下一步**: 产品经理和数据架构师角色分析完成后，进行综合整合
